{
  "permissions": {
    "allow": [
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "WebFetch(domain:c251229.vercel.app)",
      "Bash(npm run build:*)",
      "Skill(frontend-design)",
      "WebFetch(domain:c251231.vercel.app)",
      "Bash(node -e \"\nconst ExcelJS = require\\(''exceljs''\\);\nconst fs = require\\(''fs''\\);\nconst { createClient } = require\\(''@supabase/supabase-js''\\);\n\n// .env.local에서 환경변수 읽기\nconst envContent = fs.readFileSync\\(''.env.local'', ''utf-8''\\);\nconst envVars = {};\nenvContent.split\\(''\\\\n''\\).forEach\\(line => {\n  const [key, ...valueParts] = line.split\\(''=''\\);\n  if \\(key && valueParts.length > 0\\) {\n    envVars[key.trim\\(\\)] = valueParts.join\\(''=''\\).trim\\(\\);\n  }\n}\\);\n\nconst supabaseUrl = envVars[''NEXT_PUBLIC_SUPABASE_URL''];\nconst supabaseKey = envVars[''NEXT_PUBLIC_SUPABASE_ANON_KEY''];\n\nif \\(!supabaseUrl || !supabaseKey\\) {\n  console.error\\(''Supabase 환경변수가 없습니다.''\\);\n  process.exit\\(1\\);\n}\n\nconst supabase = createClient\\(supabaseUrl, supabaseKey\\);\n\nasync function testUpload\\(\\) {\n  // 1. 엑셀 파싱\n  const buffer = fs.readFileSync\\(''C:/Users/user/Downloads/광명애드현황.xlsx''\\);\n  const workbook = new ExcelJS.Workbook\\(\\);\n  await workbook.xlsx.load\\(buffer\\);\n  const worksheet = workbook.worksheets[0];\n  \n  const rawData = [];\n  worksheet.eachRow\\(\\(row\\) => {\n    rawData.push\\(row.values.slice\\(1\\)\\);\n  }\\);\n\n  // 헤더 찾기\n  let headerRowIndex = -1;\n  let headers = [];\n  for \\(let i = 0; i < Math.min\\(10, rawData.length\\); i++\\) {\n    const row = rawData[i];\n    if \\(!row\\) continue;\n    const rowStr = row.map\\(c => String\\(c || ''''\\).toLowerCase\\(\\)\\).join\\('',''\\);\n    if \\(rowStr.includes\\(''역사''\\) && rowStr.includes\\(''단가''\\)\\) {\n      headerRowIndex = i;\n      headers = row.map\\(c => String\\(c || ''''\\).trim\\(\\)\\);\n      break;\n    }\n  }\n\n  // 데이터 파싱\n  const inventoryData = [];\n  for \\(let i = headerRowIndex + 1; i < rawData.length; i++\\) {\n    const row = rawData[i];\n    if \\(!row || row.every\\(c => !c\\)\\) continue;\n\n    const obj = {};\n    headers.forEach\\(\\(h, idx\\) => {\n      if \\(h && row[idx] !== undefined\\) obj[h] = row[idx];\n    }\\);\n\n    const stationName = obj[''역사''] ? String\\(obj[''역사'']\\).trim\\(\\) : '''';\n    const locationCode = obj[''위치명''] ? String\\(obj[''위치명'']\\).trim\\(\\) : '''';\n    const adType = obj[''유형''] ? String\\(obj[''유형'']\\).trim\\(\\) : ''조명'';\n    const priceMonthly = obj[''단가\\(월\\)''] ? Number\\(obj[''단가\\(월\\)'']\\) : null;\n    const adSize = obj[''크기\\(mm\\)''] ? String\\(obj[''크기\\(mm\\)'']\\).trim\\(\\) : null;\n    const line = obj[''호선''] ? String\\(obj[''호선'']\\) : '''';\n    const grade = obj[''등급''] ? String\\(obj[''등급'']\\) : '''';\n\n    if \\(stationName && locationCode && adType\\) {\n      inventoryData.push\\({\n        station_name: stationName,\n        location_code: locationCode,\n        ad_type: adType,\n        ad_size: adSize,\n        price_monthly: priceMonthly,\n        availability_status: ''AVAILABLE'',\n        description: [line ? line + ''호선'' : '''', grade ? grade + ''등급'' : ''''].filter\\(Boolean\\).join\\('' / ''\\) || null,\n        organization_id: null\n      }\\);\n    }\n  }\n\n  console.log\\(''파싱된 데이터:'', inventoryData.length, ''건''\\);\n  console.log\\(''첫 번째 데이터:'', inventoryData[0]\\);\n\n  // 2. Supabase에 업로드 \\(upsert\\)\n  console.log\\(''\\\\nSupabase에 업로드 중...''\\);\n  \n  const { data, error } = await supabase\n    .from\\(''ad_inventory''\\)\n    .upsert\\(inventoryData, { onConflict: ''station_name,location_code'' }\\)\n    .select\\(\\);\n\n  if \\(error\\) {\n    console.error\\(''업로드 오류:'', error.message\\);\n    console.error\\(''상세:'', error\\);\n  } else {\n    console.log\\(''업로드 성공:'', data?.length || 0, ''건''\\);\n  }\n\n  // 3. 확인 조회\n  console.log\\(''\\\\n인벤토리 조회 중...''\\);\n  const { data: inventory, error: selectError } = await supabase\n    .from\\(''ad_inventory''\\)\n    .select\\(''*''\\)\n    .order\\(''station_name''\\)\n    .limit\\(10\\);\n\n  if \\(selectError\\) {\n    console.error\\(''조회 오류:'', selectError.message\\);\n  } else {\n    console.log\\(''조회 결과:'', inventory?.length || 0, ''건''\\);\n    if \\(inventory && inventory.length > 0\\) {\n      inventory.forEach\\(\\(item, i\\) => {\n        console.log\\(\\(i+1\\) + ''.'', item.station_name, ''|'', item.location_code, ''|'', item.ad_type, ''|'', item.price_monthly?.toLocaleString\\(\\) + ''원''\\);\n      }\\);\n    }\n  }\n}\n\ntestUpload\\(\\).catch\\(console.error\\);\n\")",
      "Bash(node -e:*)"
    ]
  }
}
